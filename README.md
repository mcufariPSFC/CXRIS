# CXRIS

CXRIS is an x-ray image post-processor for hydro and rad-hydro codes. Compatible currently only with spherical geometry AMR or fixed-grid eulerian codes

## Specification and Phenomenology

CXRIS can be used to generate penumbral images of arbitrary source geometries (so long as they can be mapped to spherical grids) and allows the user to specify the number of pinholes and their geometry in the input files. CXRIS also allows users to specify multiple films/detection screens with adaptive filtration to simulate the attenuation of some of the rays before reaching the detection screen. CXRIS penumbral images are generated by launching rays from pixels through micro-aperature centers and converge to true aperature geometry in the limit that the number of aperature cells approaches infinity. Aperature cells ought to be generated iteratively such that each has equal area to save time computing the solid angle some source cell is radiating into. 

CXRIS aperature arrays are specified in the inputs files with geometry scaled to your hydro code units of choice. Default is cm

CXRIS uses film-screen adaptive refinement (FSAR) to enable increased resolution of sources, esp in the outer edge of a penumbral image. A given pixel is split into 8 upon detection of a splitting criterion satisfying the 3/2 rule for pixel splitting. The 8 children pixels are the left, top-left, etc. spaced evenly around the original. The data structure that holds these adaptive pixels is an "oct-tree" and is specified in the Pixel class. Note that the refinement parameter in the image plate input file specifies the number of splits a pixel may undergo.

CXRIS Grids use bounding volume hierarchy to save on the number of necessary ray-object intersections that are calculated. The outermost spherical structure are the octant-shells with each sub division split into quarters along the zenith and azimuth axis. This enables fast computation of the most sub-cell that a ray intersects. An intersecting ray is propagated through the grid by ordering the intersection points (if any) with the walls and inner and outer shells to determine the nearest intersection and propagating the ray into the next cell along it's direction vector.

The ray-image intensity algorithm uses a model of atomic processes to determine the emission spectra of the source

## Usage

The user should specify the geometry of their imager and filtering configuration/stack of films per camera and use the CID and IMAGEPLATE CID syntax to assign image plates to certain cameras. The user should specify their grid geometry and maximum refinement and/or refinement criterion. It's essential that hydro data is read in with the proper geometry for imaging to work.

The user may then compile and run the code to produce images.

## Compilation

The software may be compiled with CMake. If the version of the software the user has contains a Makefile with only a few lines, please ignore or delete this file.
E.g. while in the CXRIS directory
Modify the lines in the CMakeLists.txt file to specify the locaiton of the gcc compilers on your system.
Create a directory for the built executable to live in

`mkdir build`

`cd build`

from inside the build directory

`cmake ..`

`make`

Then to run cxris

`./cxris`

And that's all.

## Distribution of this software
Please do not distribute unofficial versions of this software. 
